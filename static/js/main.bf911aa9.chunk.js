(this.webpackJsonpfactorymustgrow=this.webpackJsonpfactorymustgrow||[]).push([[0],{11:function(e,t,n){},12:function(e,t,n){},13:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n.n(r),a=n(6),o=n.n(a),i=(n(11),n(3)),u=(n(12),n(13),n(4)),s=n(1),p={Name:"Assembler",Icon:"assembling-machine-1",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},d={Name:"Miner",Icon:"electric-mining-drill",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},l={Name:"Iron Ore",Icon:"iron-ore",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},m={Name:"Copper Ore",Icon:"copper-ore",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},y={Name:"Copper Plate",Icon:"copper-plate",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},j={Name:"Copper Wire",Icon:"copper-cable",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},C={Name:"Stone Furnace",Icon:"stone-furnace",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},S={Name:"Stone",Icon:"stone",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},g={Name:"Iron Plate",Icon:"iron-plate",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},b={Name:"Gear",Icon:"iron-gear-wheel",StackSize:100,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},O={Name:"Green Chip",Icon:"electronic-circuit",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},N=[{Name:"Iron Ore",Icon:"iron-ore",DurationSeconds:1,ProducerType:"Miner",Input:[],Output:[{Entity:l,Count:1}]},{Name:"Copper Ore",Icon:"copper-ore",DurationSeconds:1,ProducerType:"Miner",Input:[],Output:[{Entity:m,Count:1}]},{Name:"Stone",Icon:"stone",DurationSeconds:1,ProducerType:"Miner",Input:[],Output:[{Entity:S,Count:1}]},{Name:"Stone Furnace",Icon:"stone-furnace",DurationSeconds:1,ProducerType:"Assembler",Input:[{Entity:S,Count:5}],Output:[{Entity:C,Count:1}]},{Name:"Iron Plate",Icon:"iron-plate",DurationSeconds:1,ProducerType:"Smelter",Input:[{Entity:l,Count:1}],Output:[{Entity:g,Count:1}]},{Name:"Copper Plate",Icon:"copper-plate",DurationSeconds:1,ProducerType:"Smelter",Input:[{Entity:m,Count:1}],Output:[{Entity:y,Count:1}]},{Name:"Copper Wire",Icon:"copper-cable",DurationSeconds:1,ProducerType:"Assembler",Input:[{Entity:y,Count:1}],Output:[{Entity:j,Count:2}]},{Name:"Gear",Icon:"iron-gear-wheel",DurationSeconds:1,ProducerType:"Assembler",Input:[{Entity:g,Count:2}],Output:[{Entity:b,Count:1}]},{Name:"Green Chip",Icon:"electronic-circuit",DurationSeconds:1,ProducerType:"Assembler",Input:[{Entity:j,Count:3},{Entity:g,Count:1}],Output:[{Entity:O,Count:1}]},{Name:"Miner",Icon:"electric-mining-drill",DurationSeconds:1,ProducerType:"Assembler",Input:[{Entity:g,Count:10},{Entity:b,Count:5},{Entity:O,Count:3}],Output:[{Entity:d,Count:1}]},{Name:"Assembler",Icon:"assembling-machine-1",DurationSeconds:1,ProducerType:"Assembler",Input:[{Entity:g,Count:9},{Entity:b,Count:5},{Entity:O,Count:3}],Output:[{Entity:p,Count:1}]},{Name:"Iron Chest",Icon:"iron-chest",DurationSeconds:1,ProducerType:"Assembler",Input:[{Entity:g,Count:8}],Output:[{Entity:{Name:"Iron Chest",Icon:"iron-chest",StackSize:50,StorageUpgradeType:"Solid",ResearchUpgradeItems:[]},Count:1}]}],f=Object(u.a)(N.map((function(e){return[e.Name,e]})));function h(e){var t=f.get(e);if(!t)throw"Failed to find recipe ".concat(e);return t}var E=function(e,t){return e.get(t.Name)||0},I=function(e,t){return t.StackSize*(1+(e.get(t.Name)||0))},P=function(e,t){return function(e,t){var n=!0;return t.forEach((function(t){var r=t.Entity,c=t.Count;E(e,r)<c&&(n=!1)})),n}(e,t)?[e.withMutations((function(e){t.forEach((function(t){var n=t.Entity,r=t.Count;e.update(n.Name,(function(e){return(e||0)-r}))}))})),!0]:[e,!1]},v=function(e,t,n){return function(e,t,n){var r=!0;return n.forEach((function(n){var c=n.Entity,a=n.Count;E(e,c)+a>I(t,c)&&(r=!1)})),r}(e,t,n)?[e.withMutations((function(e){n.forEach((function(t){var n=t.Entity,r=t.Count;e.update(n.Name,(function(e){return(e||0)+r}))}))})),!0]:[e,!1]};function x(e,t){switch(e){case"Assembler":return[{Entity:p,Count:1}];case"Smelter":return[{Entity:C,Count:1}];case"Miner":return[{Entity:d,Count:1}];case"ChemFactory":case"Refinery":case"Pumpjack":return[]}}function R(e,t){var n=t.type,r=t.producerName,c=e.EntityProducers.get(r);if(!c)return console.log("Cannot find producer with name ".concat(r)),e;var a,o=h(c.RecipeName),u=e.EntityCounts,p=e.EntityStorageCapacityUpgrades,d=e.EntityProducers;switch(n){case"Produce":var l=P(u,o.Input),m=Object(i.a)(l,2);if(u=m[0],a=m[1]){var y=v(u,p,o.Output),j=Object(i.a)(y,2);u=j[0],a=j[1]}return a?Object(s.a)(Object(s.a)({},e),{},{EntityCounts:u}):e;case"AddProducer":if(c.ProducerCount>50)return e;var C=P(u,x(o.ProducerType,c.ProducerCount)),S=Object(i.a)(C,2);return u=S[0],(a=S[1])?(d=d.set(r,Object(s.a)(Object(s.a)({},c),{},{ProducerCount:(c.ProducerCount||0)+1})),Object(s.a)(Object(s.a)({},e),{},{EntityCounts:u,EntityProducers:d})):e;case"RemoveProducer":if(c.ProducerCount<=0)return e;var g=v(u,p,x(o.ProducerType,c.ProducerCount)),b=Object(i.a)(g,2);return u=b[0],(a=b[1])?(d=d.set(r,Object(s.a)(Object(s.a)({},c),{},{ProducerCount:(c.ProducerCount||0)-1})),Object(s.a)(Object(s.a)({},e),{},{EntityCounts:u,EntityProducers:d})):e;case"UpgradeStorage":case"AddProducerCapacity":case"RemoveProducerCapacity":case"UpgradeResearch":default:return e}}var U=n(0),k={Assembler:"assembling-machine-1",Smelter:"stone-furnace",Miner:"electric-mining-drill",ChemFactory:"",Refinery:"",Pumpjack:""},T=function(e){return k[h(e.RecipeName).ProducerType]},A=function(e){var t=e.recipe;return Object(U.jsxs)("div",{className:"recipe",children:[Object(U.jsx)("span",{children:"Recipe: "}),t.Input.map((function(e,t){return Object(U.jsxs)("span",{children:[Object(U.jsx)("span",{children:e.Count}),Object(U.jsx)("div",{className:"icon ".concat(e.Entity.Icon)})]},t)})),Object(U.jsx)("span",{children:"="}),t.Output.map((function(e,t){return Object(U.jsxs)("span",{children:[Object(U.jsx)("span",{children:e.Count}),Object(U.jsx)("div",{className:"icon ".concat(e.Entity.Icon)})]},t)}))]})},w=function(e){var t=e.producer,n=e.dispatch,r=e.globalEntityCount,c=e.entityStorageCapacity;if(!t)return Object(U.jsx)("div",{className:"NoProducer"});var a,o,i=h(t.RecipeName);return Object(U.jsxs)("div",{className:"Producer",children:[Object(U.jsx)("div",{className:"title",children:Object(U.jsxs)("span",{children:[t.RecipeName," "]})}),Object(U.jsxs)("div",{className:"infoRow",children:[Object(U.jsx)("div",{onClick:function(){n({producerName:t.RecipeName,type:"Produce"})},className:i.Icon+" icon clickable"}),Object(U.jsx)("div",{className:"rate",children:(o=t,a=1/h(o.RecipeName).DurationSeconds*o.ProducerCount,"".concat(a,"/m"))}),Object(U.jsxs)("div",{className:"plusMinus",children:[Object(U.jsx)("span",{onClick:function(){return n({producerName:t.RecipeName,type:"AddProducer"})},className:"clickable",children:"+"}),Object(U.jsx)("span",{onClick:function(){return n({producerName:t.RecipeName,type:"RemoveProducer"})},className:"clickable",children:"-"})]}),Object(U.jsx)("span",{className:"icon producerTypeIcon ".concat(T(t))}),Object(U.jsxs)("div",{className:"producerCount",children:[Object(U.jsx)("span",{className:"currentCapacity",children:t.ProducerCount}),Object(U.jsx)("span",{children:"/"}),Object(U.jsx)("span",{className:"maxCapacity",children:50})]}),Object(U.jsxs)("div",{className:"plusMinus maxCapacity",children:[Object(U.jsx)("span",{onClick:function(){return n({producerName:t.RecipeName,type:"AddProducerCapacity"})},className:"clickable",children:"+"}),Object(U.jsx)("span",{onClick:function(){return n({producerName:t.RecipeName,type:"RemoveProducerCapacity"})},className:"clickable",children:"-"})]}),Object(U.jsx)("div",{onClick:function(){return n({producerName:t.RecipeName,type:"UpgradeStorage"})},className:"icon iron-chest clickable"}),Object(U.jsx)("div",{className:"filler"}),Object(U.jsx)("div",{className:"icon space-science-pack clickable"})]}),Object(U.jsxs)("div",{className:"infoRow",children:[Object(U.jsxs)("span",{className:"count",children:[r(i.Output[0].Entity),"/",c(i.Output[0].Entity)]}),i.Input.length>0?Object(U.jsx)(A,{recipe:i}):Object(U.jsx)("div",{})]})]})};var D={EntityCounts:Object(u.a)(JSON.parse(localStorage.getItem("EntityCounts")||"")||{Miner:3}),EntityStorageCapacityUpgrades:Object(u.a)(JSON.parse(localStorage.getItem("EntityStorageUpgrades")||"")||{}),EntityProducers:Object(u.a)(JSON.parse(localStorage.getItem("EntityProducers")||"")||N.map((function(e){return[e.Name,(t=e.Name,{RecipeName:t,ProducerCount:0,ProducerCapacityUpgradeCount:0,ProducerMaxCapacityUpgradeCount:0,ResearchUpgradeCount:0})];var t})))};var M=function(){var e=Object(r.useReducer)(R,D),t=Object(i.a)(e,2),n=t[0],c=t[1],a=function(e){return E(n.EntityCounts,e)},o=function(e){return I(n.EntityStorageCapacityUpgrades,e)};!function(e,t){var n=Object(r.useRef)();Object(r.useEffect)((function(){n.current=e})),Object(r.useEffect)((function(){var e=setInterval((function(){null!=n.current&&n.current()}),t);return function(){return clearInterval(e)}}),[t])}((function(){n.EntityProducers.forEach((function(e,t){for(var n=0;n<e.ProducerCount;n++)c({producerName:t,type:"Produce"})}))}),1e3),Object(r.useEffect)((function(){!function(e){localStorage.setItem("EntityCounts",JSON.stringify(e.EntityCounts.toJSON())),localStorage.setItem("EntityStorageUpgrades",JSON.stringify(e.EntityStorageCapacityUpgrades.toJSON())),localStorage.setItem("EntityProducers",JSON.stringify(e.EntityProducers.toJSON()))}(n)}),[n]);var u=N.map((function(e){return Object(U.jsx)(w,{producer:n.EntityProducers.get(e.Name),dispatch:c,globalEntityCount:a,entityStorageCapacity:o},e.Name)}));return Object(U.jsxs)("div",{className:"App",children:[u,Object(U.jsx)("a",{href:"https://github.com/compnski/factorymustgrow",children:"Github"})]})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,16)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),c(e),a(e),o(e)}))};o.a.render(Object(U.jsx)(c.a.StrictMode,{children:Object(U.jsx)(M,{})}),document.getElementById("root")),z()}},[[15,1,2]]]);
//# sourceMappingURL=main.bf911aa9.chunk.js.map